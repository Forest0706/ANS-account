# 物流财务台账管理系统 - 用户操作手册

## 1. 系统概述

### 1.1 系统简介
物流财务台账管理系统是专门为物流货物代理业开发的财务管理软件，主要用于管理进出口业务的费用收支、结算和支付流程。系统采用本地存储方式，所有数据保存在浏览器本地，无需服务器支持。

### 1.2 主要功能
- **往来单位管理**：管理客户和供应商信息
- **费用项目管理**：维护各种费用项目
- **支付条件管理**：设置不同的支付条件
- **台账管理**：核心业务功能，包括台账创建、子发票管理、费用明细录入
- **PDF输出**：生成专业的发票PDF文件
- **数据备份**：支持数据导出和导入

### 1.3 系统特点
- 完全本地化运行，无需网络连接
- 响应式设计，支持PC端使用
- 实时计算，自动汇总统计
- 数据安全可靠，支持自动备份

## 2. 系统登录与主界面

### 2.1 系统访问
1. 打开浏览器（推荐使用Chrome、Edge、Firefox或Safari最新版）
2. 访问系统地址（本地HTML文件）
3. 系统自动加载并显示主界面

### 2.2 主界面布局
```
┌─────────────────────────────────────────────────────────────┐
│  物流财务台账管理系统 - 主菜单                            │
├─────────────────────────────────────────────────────────────┤
│  [往来单位] [费用项目] [支付条件] [台账管理] [数据备份]    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                    主要功能区域                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.3 导航说明
- **往来单位**：管理客户和供应商信息
- **费用项目**：维护费用项目主数据
- **支付条件**：设置支付条件
- **台账管理**：核心业务功能
- **数据备份**：数据导出和导入

## 3. 往来单位管理

### 3.1 功能概述
管理所有的客户和供应商信息，包括基本资料、联系方式、支付条件等。

### 3.2 操作步骤

#### 3.2.1 查看往来单位列表
1. 点击主菜单中的"往来单位"
2. 系统显示往来单位列表页面

#### 3.2.2 新增往来单位
1. 在往来单位列表页面，点击"新增"按钮
2. 在弹出的表单中填写以下信息：
   - **往来单位编码**：系统自动生成（格式：ANSC-010000开始）
   - **公司名称**：必填，输入完整的客户或供应商名称
   - **往来单位区分**：选择【客户】、【供应商】或两者都选
   - **联系电话**：选填，格式：XXX-XXXX-XXXX
   - **邮政编码**：选填，格式：XXX-XXXX
   - **地址**：必填，输入完整地址
   - **法人番号**：选填，13位数字
   - **营业担当**：选填，选择负责人
   - **默认支付条件**：选填，选择默认的支付条件
3. 点击"保存"按钮完成新增

#### 3.2.3 编辑往来单位
1. 在列表中找到需要编辑的单位
2. 点击该行对应的"编辑"按钮
3. 修改相关信息
4. 点击"保存"按钮完成修改

#### 3.2.4 删除往来单位
1. 在列表中找到需要删除的单位
2. 点击该行对应的"删除"按钮
3. 系统弹出确认对话框
4. 点击"确定"完成删除

**注意**：删除往来单位前，请确保该单位没有被台账引用。

### 3.3 查询和筛选
- **搜索功能**：在搜索框中输入公司名称关键词进行搜索
- **筛选功能**：按往来单位区分进行筛选（客户/供应商）
- **排序功能**：点击列标题进行排序

## 4. 费用项目管理

### 4.1 功能概述
维护各种费用项目，包括费用名称、代码、货币、计量单位、税区分等。

### 4.2 操作步骤

#### 4.2.1 查看费用项目列表
1. 点击主菜单中的"费用项目"
2. 系统显示费用项目列表页面

#### 4.2.2 新增费用项目
1. 在费用项目列表页面，点击"新增"按钮
2. 在弹出的表单中填写以下信息：
   - **费用项目名称**：必填，如"海上运费代垫费用"
   - **费用代码**：必填，如"BL LATE PICK FEE"
   - **货币**：必填，选择JPY、USD、CNY等
   - **计量单位**：必填，选择件、叶、时间、40HQ、20GP等
   - **税区分**：必填，选择【免税】或【课税】
   - **备注**：选填，输入相关说明
3. 点击"保存"按钮完成新增

#### 4.2.3 编辑和删除
操作方式与往来单位管理类似。

## 5. 支付条件管理

### 5.1 功能概述
设置不同的支付条件，用于自动计算支付期限。

### 5.2 支付条件类型
- **締日模式**：月末结算，次月指定日支付
- **天数计算模式**：从请款日起算，指定天数后支付

### 5.3 操作步骤

#### 5.3.1 新增支付条件
1. 点击主菜单中的"支付条件"
2. 点击"新增"按钮
3. 填写以下信息：
   - **支付条件名称**：必填，如"月末结算次月末支付"
   - **条件区分**：选择【締日】或【天数计算】
   - **締日**：选择1-31日（締日模式时必填）
   - **支付期限**：输入"次月/31日"等（締日模式时）
   - **天数**：输入天数（天数计算模式时必填）
   - **状态**：选择【有效】或【无效】

#### 5.3.2 支付期限计算示例
- **締日模式**：请款日2025年9月15日，締日31日 → 支付期限2025年10月31日
- **天数模式**：请款日2025年9月15日，天数30天 → 支付期限2025年10月15日

## 6. 台账管理（核心功能）

### 6.1 功能概述
台账管理是整个系统的核心功能，包括台账创建、基础海运数据录入、子发票管理、费用明细录入等。

### 6.2 操作流程
```
创建台账 → 录入基础海运数据 → 创建子发票 → 录入收费明细 → 录入付费明细 → 查看汇总
```

### 6.3 台账列表

#### 6.3.1 查看台账列表
1. 点击主菜单中的"台账管理"
2. 系统显示台账列表页面
3. 列表显示以下信息：
   - 台账编号
   - 客户名称
   - 船名航次
   - B/L编号
   - 创建日期
   - 负责人
   - 状态

#### 6.3.2 查询和筛选
- **搜索功能**：按台账编号、客户名称、B/L编号搜索
- **筛选功能**：按日期范围、状态筛选
- **排序功能**：点击列标题进行排序

### 6.4 创建新台账

#### 6.4.1 新增台账
1. 在台账列表页面，点击"新增台账"按钮
2. 系统创建新台账，自动生成台账编号（格式：ANS-YYMM0001）
3. 自动跳转到台账详情页面

### 6.5 台账详情页面

台账详情页面采用标签页设计，包含两个主要标签：

#### 6.5.1 标签1：基础海运数据
录入该台账的基本海运信息，所有子发票共用这些数据。

**录入项目**：
- **客户名称**：必填，从往来单位中选择
- **本船名**：必填，输入船舶名称
- **航次 (Voy.)**：选填，输入航次号
- **船荷证券番号 (B/L No.)**：必填，输入B/L编号
- **品名**：选填，输入货物名称
- **船公司**：选填，输入船公司名称
- **集装箱编号 (CTNR)**：选填，输入集装箱号
- **出港日 (ETD)**：选填，选择预计出港日期
- **入港日 (ETA)**：选填，选择预计入港日期
- **积港 (POL)**：选填，输入装货港
- **扬港 (POD)**：选填，输入卸货港
- **数量**：选填，输入货物数量
- **重量**：选填，输入货物重量
- **容积**：选填，输入货物容积
- **许可番号**：选填，输入许可证号
- **发票番号 (INV No.)**：选填，输入发票编号
- **备注**：选填，输入相关说明

**操作步骤**：
1. 选择客户名称（系统会自动加载往来单位列表）
2. 依次填写各项信息
3. 点击"保存"按钮保存基础数据

#### 6.5.2 标签2：台账（子发票管理）
管理该台账下的所有子发票，可以创建多个子发票。

### 6.6 子发票管理

#### 6.6.1 创建子发票
1. 在台账详情页面，点击"标签2：台账"
2. 点击"新建子发票"按钮
3. 系统创建新的子发票，自动生成编号（格式：母台账编号-A、-B、-C...）
4. 录入子发票基本信息：
   - **结算单位**：必填，选择客户或供应商
   - **请款区分**：必填，选择【通常请款】或【代垫请款】
   - **请款日**：必填，选择请款日期
   - **支付期限**：系统自动计算（根据结算单位的支付条件）
   - **备注**：选填，输入相关说明

#### 6.6.2 收费明细录入（表格上部）
录入向客户收取的费用。

**表格字段**：
- **状态**：下拉选择【未确认】→【确认済】→【请款済】→【入金済】
- **费用项目**：下拉选择费用项目
- **数量**：输入数量
- **单位**：自动显示（从费用项目获取）
- **区分**：自动显示【免税】或【课税】
- **货币**：自动显示（从费用项目获取）
- **单价**：输入单价
- **汇率**：输入汇率，默认1
- **金额**：自动计算（单价×数量×汇率）
- **备注**：输入说明

**操作说明**：
- 点击"添加行"增加新费用项目
- 状态变为"确认済"后，该行数据将被锁定，不能编辑
- 可以通过"状态回退"功能解除锁定
- 系统实时计算各项汇总

#### 6.6.3 付费明细录入（表格下部）
录入需要支付给供应商的费用。

**特殊功能**：
- **【收费复制】按钮**：一键将收费明细的全部内容复制到付费明细
- **独立设置**：付费明细的结算单位和请款日可以独立设置
- **供应商筛选**：只显示往来单位区分包含【供应商】的单位

**操作步骤**：
1. 点击"添加行"增加费用项目
2. 选择供应商（系统只显示供应商类型的往来单位）
3. 录入费用明细
4. 可以使用"收费复制"功能快速录入

### 6.7 自动计算功能

系统提供实时自动计算功能：

#### 6.7.1 收费汇总计算
```
收费免税合计 = SUM(收费表格中区分='免税'的金额)
收费课税合计 = SUM(收费表格中区分='课税'的金额)
收费消费税 = 收费课税合计 × 10%（四舍五入）
收费总计 = 收费免税合计 + 收费课税合计 + 收费消费税
```

#### 6.7.2 付费汇总计算
```
付费免税合计 = SUM(付费表格中区分='免税'的金额)
付费课税合计 = SUM(付费表格中区分='课税'的金额)
付费消费税 = 付费课税合计 × 10%（四舍五入）
付费总计 = 付费免税合计 + 付费课税合计 + 付费消费税
```

#### 6.7.3 毛利计算
```
毛利（税抜） = (收费免税合计 + 收费课税合计) - (付费免税合计 + 付费课税合计)
毛利（税込） = 收费总计 - 付费总计
```

**重要说明**：
- ❗ 消费税只对课税项目的合计金额计算一次（不是逐行计算）
- ❗ 消费税采用四舍五入方式
- ❗ 免税项目不计入消费税计算

### 6.8 状态管理

子发票的状态流程：
```
【未确认】→【确认済】→【请款済】→【入金済】
```

**状态说明**：
- **未确认**：可以编辑所有字段
- **确认済**：锁定数据，不能编辑（可通过状态回退解除）
- **请款済**：表示已向客户请款
- **入金済**：表示已收到客户付款

## 7. PDF输出功能

### 7.1 功能概述
系统可以将子发票生成专业的PDF格式发票文件。

### 7.2 生成PDF
1. 在台账详情页面，选择要输出的子发票
2. 点击"生成PDF"按钮
3. 系统生成PDF文件并自动下载

### 7.3 PDF格式
PDF文件包含以下内容：
- 发票抬头和编号
- 客户信息
- 费用明细表格
- 税额 breakdown
- 银行转账信息
- 备注说明

### 7.4 文件命名
下载的PDF文件自动命名为：`请款书_{请款编号}_{YYYYMMDD}.pdf`

## 8. 数据备份功能

### 8.1 数据导出
1. 点击主菜单中的"数据备份"
2. 点击"导出数据"按钮
3. 系统生成JSON格式的备份文件
4. 自动下载备份文件到本地

**备份文件包含**：
- 所有往来单位数据
- 所有费用项目数据
- 所有支付条件数据
- 所有台账数据
- 所有子发票数据
- 所有费用明细数据

### 8.2 数据导入
1. 点击"导入数据"按钮
2. 选择要导入的JSON备份文件
3. 系统显示导入确认对话框
4. 确认后，系统导入数据并覆盖现有数据

**注意事项**：
- 导入操作会覆盖现有数据，请谨慎操作
- 建议导入前先导出当前数据进行备份
- 导入文件必须是系统导出的JSON格式

### 8.3 自动备份
系统每天第一次使用时自动进行数据备份，备份文件保存在浏览器的下载文件夹中。

## 9. 常见操作场景

### 9.1 新建完整台账流程
1. **准备工作**：
   - 确保往来单位中已经录入了相关客户和供应商
   - 确保费用项目中已经录入了需要的费用项目
   - 确保支付条件中已经设置了相关条件

2. **创建台账**：
   - 进入"台账管理"
   - 点击"新增台账"
   - 录入基础海运数据
   - 保存基础数据

3. **创建子发票**：
   - 切换到"台账"标签
   - 点击"新建子发票"
   - 录入子发票基本信息

4. **录入费用**：
   - 在收费明细表格中录入向客户收取的费用
   - 在付费明细表格中录入需要支付的费用
   - 系统实时计算各项汇总

5. **确认和输出**：
   - 确认所有数据无误
   - 将状态改为"确认済"
   - 生成PDF发票文件

### 9.2 代垫费用处理
当代垫供应商费用时：
1. 创建子发票时选择【代垫请款】
2. 在收费明细中录入向客户收取的代垫费用
3. 在付费明细中录入实际需要支付给供应商的费用
4. 毛利即为代垫业务的利润

### 9.3 多币种处理
1. 在费用项目中设置不同的货币
2. 录入明细时系统显示对应的货币
3. 输入实际的汇率进行换算
4. 系统按汇率计算本位币金额

## 10. 注意事项和最佳实践

### 10.1 数据录入注意事项
- **编码规则**：系统自动生成编码，不要手动修改
- **必填项目**：确保所有必填项目都已填写
- **日期格式**：使用系统提供的日期选择器，确保格式正确
- **金额精度**：金额精确到个位，系统会自动进行四舍五入
- **税率计算**：消费税按10%计算，只对课税项目征收

### 10.2 操作最佳实践
- **定期备份**：建议每周进行数据备份
- **数据验证**：录入完成后仔细检查数据准确性
- **状态管理**：按照实际业务流程更新状态
- **分类管理**：合理设置往来单位区分，便于后续筛选
- **费用标准化**：建立标准的费用项目库，保持数据一致性

### 10.3 系统维护
- **浏览器兼容性**：使用推荐的现代浏览器
- **数据清理**：定期清理无用的历史数据
- **性能优化**：数据量较大时使用搜索和筛选功能
- **安全注意**：不要在公共电脑上保存敏感数据

### 10.4 故障排除
- **数据丢失**：检查是否误操作，尝试从备份文件恢复
- **计算错误**：检查输入数据的逻辑关系，特别是日期和金额
- **显示问题**：尝试刷新页面或清除浏览器缓存
- **功能异常**：检查浏览器控制台是否有错误信息

## 11. 快捷键和操作技巧

### 11.1 快捷键
- **Tab**：在表单字段间切换
- **Enter**：保存当前表单
- **Esc**：关闭弹窗或取消操作
- **Ctrl+S**：快速保存（部分页面支持）

### 11.2 操作技巧
- **快速搜索**：在列表页面使用搜索框快速定位数据
- **批量操作**：可以连续添加多行明细数据
- **模板使用**：建立常用的费用项目作为模板
- **数据复制**：利用收费复制功能快速录入付费数据

这个用户操作手册涵盖了系统的所有功能模块和操作流程，能够帮助用户快速上手并正确使用系统。建议用户在实际操作前先通读本手册，了解系统的基本操作方法和注意事项。